# valuesModelAppliance.yaml is used for,
#  -------------------         
# | Deployment scale  |        
#  -------------------         
# | 10K subscribers   |        
#  -------------------         
# non-HA,non-slicing AAC Variant deployment with this model requires following footprint,
#  --------------------------------------------------
# |   vCPU  |  Memory (GB)  | (Shared) Storage (GB)  |
#  --------------------------------------------------
# |    32   |     96        |           770          |
#  --------------------------------------------------
#  
#***The above information is for a quick reference, for more information please refer to the NOKIA documentation***

tags:
  rdof: false

altiplano-indexsearch:
  bssc-indexsearch:
    manager:
      resources:
        limits:
          cpu: 1
          memory: 2Gi
        requests:
          cpu: 100m
          memory: 1500Mi
      java_opts: "-Xms1g -Xmx1g -Dlog4j2.formatMsgNoLookups=true"

    client:
      resources:
        limits:
          cpu: 1
          memory: 4Gi
        requests:
          cpu: 500m
          memory: 2Gi
      java_opts: "-Xms2g -Xmx2g -Dlog4j2.formatMsgNoLookups=true"

    data:
      resources:
        limits:
          cpu: 2
          memory: 6Gi
        requests:
          cpu: 500m
          memory: 3Gi
      java_opts: "-Xms3g -Xmx3g -Dlog4j2.formatMsgNoLookups=true"

    cbur:
      cbura:
        resources:
          limits:
            cpu: 1
            memory: 2Gi
          requests:
            cpu: 500m
            memory: 1Gi

    jobs:
      secAdminUpgradeJob:
        resources:
          requests:
            cpu: 200m
            memory: 500Mi
          limits:
            cpu: 500m
            memory: 1Gi

  bssc-dashboards:
    dashboards:
      resources:
        limits:
          cpu: 1
          memory: 2Gi
        requests:
          cpu: 500m
          memory: 1Gi

  bssc-indexmgr:
    curator:
      resources:
        limits:
          cpu: 200m
          memory: "1Gi"
        requests:
          cpu: "100m"
          memory: "100Mi"

  bssc-fluentd:
    fluentd:
      resources:
        requests:
          cpu: 200m
          memory: 1Gi
        limits:
          cpu: 1
          memory: 2Gi

altiplano-mariadb:
  mariadb:
    resources:
      requests:
        memory: 2Gi
        cpu: 500m
      limits:
        memory: 4Gi
        cpu: 1
    metrics:
      resources:
        requests:
          memory: 256Mi
          cpu: 250m
        limits:
          memory: 256Mi
          cpu: 250m
    ## A customized mysqld.conf to import
    mysqld_site_conf: |-
      [mysqld]
      version = 24.6.1-REL_256-altiplano-infra-MariaDB
      skip-host-cache
      skip-name-resolve
      datadir		= /mariadb/data
      lc_messages_dir	= /usr/share/mysql
      lc_messages	= en_US
      skip-external-locking
      #
      # * Fine Tuning
      #
      max_connections		= 200
      connect_timeout		= 5
      wait_timeout		= 1800
      max_allowed_packet	= 100M
      thread_cache_size       = 128
      sort_buffer_size	= 4M
      bulk_insert_buffer_size	= 16M
      tmp_table_size		= 32M
      max_heap_table_size	= 32M
      #
      # * MyISAM
      #
      # This replaces the startup script and checks MyISAM tables if needed
      # the first time they are touched. On error, make copy and try a repair.
      myisam_recover_options = BACKUP
      key_buffer_size		= 128M
      #open-files-limit	= 2000
      table_open_cache	= 400
      myisam_sort_buffer_size	= 512M
      concurrent_insert	= 2
      read_buffer_size	= 2M
      read_rnd_buffer_size	= 1M
      #
      # * Query Cache Configuration
      #
      # Cache only tiny result sets, so we can fit more in the query cache.
      query_cache_limit		= 128K
      query_cache_size		= 64M
      # for more write intensive setups, set to DEMAND or OFF
      #query_cache_type		= DEMAND
      #
      # * Logging and Replication
      #
      # Both location gets rotated by the cronjob.
      # Be aware that this log type is a performance killer.
      # As of 5.1 you can enable the log at runtime!
      #general_log_file        = /var/log/mysql/mysql.log
      #general_log             = 1
      #
      # Error logging goes to syslog due to /etc/mysql/conf.d/mysqld_safe_syslog.cnf.
      #
      # we do want to know about network errors and such
      #log_warnings		= 2
      #
      # Enable the slow query log to see queries with especially long duration
      #slow_query_log[={0|1}]
      slow_query_log_file	= /var/log/mysql/mariadb-slow.log
      long_query_time = 10
      #log_slow_rate_limit	= 1000
      #log_slow_verbosity	= query_plan

      #log-queries-not-using-indexes
      #log_slow_admin_statements
      #
      # The following can be used as easy to replay backup logs or for replication.
      # note: if you are setting up a replication slave, see README.Debian about
      #       other settings you may need to change.
      #server-id		= 1
      #report_host		= master1
      #auto_increment_increment = 2
      #auto_increment_offset	= 1
      #log_bin			= /var/log/mysql/mariadb-bin
      #log_bin_index		= /var/log/mysql/mariadb-bin.index
      # not fab for performance, but safer
      #sync_binlog		= 1
      expire_logs_days	= 1
      max_binlog_size         = 100M
      # slaves
      #relay_log		= /var/log/mysql/relay-bin
      #relay_log_index	= /var/log/mysql/relay-bin.index
      #relay_log_info_file	= /var/log/mysql/relay-bin.info
      #log_slave_updates
      #read_only
      #
      # If applications support it, this stricter sql_mode prevents some
      # mistakes like inserting invalid dates etc.
      #sql_mode		= NO_ENGINE_SUBSTITUTION,TRADITIONAL
      #
      # * InnoDB
      #
      # InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/.
      # Read the manual for more InnoDB related options. There are many!
      default_storage_engine	= InnoDB
      # you can't just change log file size, requires special procedure
      #innodb_log_file_size	= 50M
      innodb_buffer_pool_size	= 1G
      innodb_log_buffer_size	= 8M
      innodb_file_per_table	= 1
      innodb_open_files	= 400
      innodb_io_capacity	= 400
      innodb_flush_method	= O_DIRECT
      innodb_read_only_compressed = OFF
      tls_version = TLSv1.2,TLSv1.3

  admin:
    resources:
      limits:
        cpu: 500m
        memory: 512Mi
      requests:
        cpu: 250m
        memory: 256Mi

  maxscale:
    resources:
      requests:
        memory: 256Mi
        cpu: 250m
      limits:
        memory: 512Mi
        cpu: 500m
    metrics:
      resources:
        limits:
          cpu: 250m
          memory: 256Mi
        requests:
          cpu: 250m
          memory: 256Mi

altiplano-sso:
  resources:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: 1
      memory: 2Gi

altiplano-kafka:
  LogRetentionHours: "24"
  MessageMaxBytes: "314572800"
  resources:
    requests:
      cpu: 200m
      memory: 1Gi
    limits:
      cpu: 1
      memory: 2Gi
  JmxExporter:
    jmxResources:
      resources:
        requests:
          cpu: 100m
          memory: 100Mi
        limits:
          cpu: 200m
          memory: 1Gi

  ckaf-zookeeper:
    servers: 1
    resources:
      requests:
        cpu: 100m
        memory: 1Gi
      limits:
        cpu: 1
        memory: 2Gi
        
    JmxExporter:
      jmxResources:
        resources:
          requests:
            cpu: 100m
            memory: 100Mi
          limits:
            cpu: 200m
            memory: 1Gi

altiplano-grafana:
  resources:
    requests:
      cpu: 500m
      memory: 100Mi
    limits:
      cpu: 1
      memory: 500Mi
  grafanaUtil:
    resources:
      limits:
        cpu: 100m
        memory: 200Mi
      requests:
        cpu: 10m
        memory: 32Mi
  sidecar:
    resources:
      limits:
        cpu: 500m
        memory: 200Mi
      requests:
        cpu: 50m
        memory: 50Mi

altiplano-webdav:
  resources:
    requests:
      cpu: 500m
      memory: 512Mi
    limits:
      cpu: 2
      memory: 4Gi


altiplano-pts:
  pushgateway:
    resources:
      limits:
        cpu: 500m
        memory: 1Gi
      requests:
        cpu: 200m
        memory: 128Mi

  kubeStateMetrics:
    resources:
      limits:
        cpu: 50m
        memory: 200Mi
      requests:
        cpu: 10m
        memory: 100Mi

  nodeExporter:
    resources:
      limits:
        cpu: 500m
        memory: 200Mi
      requests:
        cpu: 100m
        memory: 100Mi

  server:
    strategy:
      rollingUpdate:
        maxSurge: 0
        maxUnavailable: 1
    type: RollingUpdate
    resources:
      limits:
        cpu: 1
        memory: 10Gi
      requests:
        cpu: 500m
        memory: 1Gi

  configmapReload:
    resources:
      limits:
        cpu: 250m
        memory: 32Mi
      requests:
        cpu: 10m
        memory: 32Mi

  cproUtil:
    resources:
      limits:
        cpu: 100m
        memory: 200Mi
      requests:
        cpu: 10m
        memory: 32Mi

altiplano-redis:
  server:
    resources:
      requests:
        memory: 512Mi
        cpu: 500m
      limits:
        memory: 2Gi
        cpu: 1
    metrics:
      resources:
        requests:
          memory: 64Mi
          cpu: 50m
        limits:
          memory: 64Mi
          cpu: 100m

  admin:
    resources:
      requests:
        memory: 100Mi
        cpu: 100m
      limits:
        memory: 200Mi
        cpu: 500m

  sentinel:
    resources:
      limits:
        cpu: 250m
        memory: 256Mi
      requests:
        cpu: 250m
        memory: 256Mi

altiplano-opentsdb-cluster:
  altiplano-opentsdb:
    env:
      init:
        TSD_UID_LRU_ID_SIZE: "400000"
        TSD_UID_LRU_NAME_SIZE: "2400000"
        TSDB_TTL: "604800"
      open:
        JVMARGS: "-XX:+UseG1GC -Xms1024m -Xmx1024m --add-opens java.base/java.nio=ALL-UNNAMED --add-opens java.security.jgss/sun.security.krb5=ALL-UNNAMED"
        HBASE_OPTS_GC_SETTING: "-XX:+UseG1GC -Xms1024m -Xmx1024m"
    resources:
      requests:
        cpu: 1
        memory: 2Gi
      limits:
        cpu: 2
        memory: 4Gi

  altiplano-hbase:
    hbase:
      master:
        resources:
          limits:
            cpu: 1
            memory: 2Gi
          requests:
            cpu: 10m
            memory: 256Mi
      regionServer:
        env:
          HBASE_HEAPSIZE: 4G
          HBASE_OPTS_GC_SETTING: "-XX:+UseG1GC"
        resources:
          limits:
            cpu: 4
            memory: 6Gi
          requests:
            cpu: 2
            memory: 4Gi

  altiplano-hdfs:
    journalNode:
      resources:
        limits:
          cpu: 500m
          memory: 2Gi
        requests:
          cpu: 10m
          memory: 256Mi
    nameNode:
      resources:
        limits:
          cpu: 500m
          memory: 2Gi
        requests:
          cpu: 10m
          memory: 256Mi
    dataNode:
      resources:
        limits:
          cpu: 1
          memory: 2Gi
        requests:
          cpu: 100m
          memory: 256Mi

altiplano-ingress:
  metrics: true
  controller:
    hostNetwork: true
    resources:
      requests:
        memory: 256Mi
        cpu: 250m
      limits:
        memory: 1Gi
        cpu: 500m
  default404:
    resources:
      limits:
        cpu: 50m
        memory: 64Mi
      requests:
        cpu: 10m
        memory: 10Mi


altiplano-opentsdb-kcproxy:
  resources:
    requests:
      cpu: 10m
      memory: 256Mi
    limits:
      cpu: 20m
      memory: 512Mi

altiplano-cbur:
  resources:
    limits:
      cpu: 1
      memory: 2Gi
    requests:
      cpu: 500m
      memory: 1Gi
      
  k8swatcher:
    resources:
      limits:
        cpu: 500m
        memory: 500Mi
      requests:
        cpu: 200m
        memory: 200Mi

  celery:
    resources:
      limits:
        cpu: 1
        memory: 4Gi
      requests:
        cpu: 500m
        memory: 2Gi

altiplano-oauth2-proxy:
  resources:
    limits:
      cpu: 500m
      memory: 300Mi
    requests:
      cpu: 100m
      memory: 200Mi
      
altiplano-installation-info:
  installationStatus:
    valuesModelAppliance: installed

