apiVersion: v1
kind: Service
metadata:
  name: {{ include "bssc-indexsearch.fullname" . |trunc ((sub .Values.customResourceNames.resourceNameLimit 10)|int) }}-discovery
  labels:
    source: opensearch
{{- include "bssc-indexsearch.commonLabels" (tuple . .Values.manager.name)  | nindent 4 }}
{{- include "bssc-indexsearch.csf-toolkit-helm.labels" (tuple .) | nindent 4 }}
  annotations:
{{- include "bssc-indexsearch.csf-toolkit-helm.annotations" (tuple .) | nindent 4 }}
spec:
  type: "ClusterIP"
  selector:
{{- include "bssc-indexsearch.selectorLabels" (tuple . .Values.manager.name )  | nindent 4 }}
  ports:
    - name: tcp-transport
      port: {{.Values.service.manager_port}}
      protocol: TCP
      appProtocol: tcp
      targetPort: tcp-transport
{{ include "bssc-indexsearch.dualStack.config" . | indent 2 }}

