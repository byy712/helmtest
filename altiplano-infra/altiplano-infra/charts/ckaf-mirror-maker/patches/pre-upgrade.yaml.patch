--- ckaf-mirror-maker-5.1.0/ckaf-mirror-maker/templates/pre-upgrade.yaml	2024-03-28 23:41:14.000000000 +0530
+++ ckaf-mirror-maker-5.1.0-nokia-patch-4/ckaf-mirror-maker/templates/pre-upgrade.yaml	2024-05-14 16:28:07.433094294 +0530
@@ -19,6 +19,7 @@
         sidecar.istio.io/inject: "false"
 {{- include "csf-common-lib.v1.customAnnotations" (tuple .Values.global.annotations) | indent 8 }}
       labels:
+        altiplano-role: {{ .Values.accessRoleLabel }}
 {{ include "ckaf-mirror-maker.commonLabels" . | indent 8 }}
 {{- include "csf-common-lib.v1.customLabels" (tuple .Values.global.labels) | indent 8 }}
     spec:
@@ -28,7 +29,7 @@
       {{- end }}
       {{- include "ckaf-mirror-maker.tolerations" . | indent 6 }}
       {{- if .Values.global.rbac.enabled }}
-      serviceAccountName: {{ template "ckaf-mirror-maker.serviceAccountName" . }}
+      serviceAccountName: {{ template "ckaf-mirror-maker.name" . }}-pre-mmadmin
       {{- end }}
       {{- if eq .Values.security.enabled true }}
       securityContext:
@@ -58,6 +59,9 @@
           readOnlyRootFilesystem: {{ .Values.security.readOnlyRootFilesystem }}
           {{- if ( ne ( toString ( .Values.security.runAsUser )) "auto" ) }}
           runAsUser: {{ .Values.security.runAsUser }}
+            {{- if .Values.security.runAsGroup }}
+          runAsGroup: {{ .Values.security.runAsGroup }}
+            {{- end }}
           {{- end }}
           allowPrivilegeEscalation: false
           {{- if eq (include "ckaf-mirror-maker.renderSeccompProfile" .) "true" }}
