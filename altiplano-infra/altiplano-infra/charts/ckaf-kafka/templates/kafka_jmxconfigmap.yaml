{{- if and (eq .Values.global.jmx.enabled true) (eq .Values.JmxExporter.metrics_limited false) }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ template "ckaf-kafka.name" . }}
  labels:
{{ include "ckaf-kafka.commonLabels" . | indent 4 }}
{{- include "csf-common-lib.v1.customLabels" (tuple .Values.global.labels) | indent 4 }}
    release: {{ .Release.Name }}
  annotations:
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: {{ .Values.global.seccompAllowedProfileNames }}
    seccomp.security.alpha.kubernetes.io/defaultProfileName: {{ .Values.global.seccompDefaultProfileName }}
{{- include "csf-common-lib.v1.customAnnotations" (tuple .Values.global.annotations) | indent 4 }}
data:
 kafka-jmx.yaml: |
  lowercaseOutputName: true
  rules:
  - pattern: ".*"
{{- end }}
