---
{{- if and (not .Values.CEPHS3.credentialName) .Values.CEPHS3.access_key .Values.CEPHS3.secret_key }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ template "cbur.fullname" . }}-secret-cephs3
  labels:
    {{- include "cbur.proxy.commonLabels" (tuple .) | indent 4 }}
    {{- include "cbur.customLabels" (tuple .Values.global.labels) | indent 4 }}
  annotations:
    {{- include "cbur.customAnnotations" (tuple .Values.global.annotations) | indent 4 }}
type: Opaque
stringData:
  {{- if .Values.CEPHS3.access_key }}
  access_key: {{ .Values.CEPHS3.access_key | quote }}
  {{- end }}
  {{- if .Values.CEPHS3.secret_key }}
  secret_key: {{ .Values.CEPHS3.secret_key | quote }}
  {{- end }}
  {{- if .Values.CEPHS3.uid }}
  uid: {{ .Values.CEPHS3.uid | quote }}
  {{- end }}
data:
  {{- if .Values.CEPHS3.ca_crt }}
  ca_crt: {{ .Values.CEPHS3.ca_crt | quote }}
  {{- end }}
{{- end }}

{{- if and (not .Values.AWSS3.credentialName) .Values.AWSS3.region }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ template "cbur.fullname" . }}-secret-awss3
  labels:
    {{- include "cbur.proxy.commonLabels" (tuple .) | indent 4 }}
    {{- include "cbur.customLabels" (tuple .Values.global.labels) | indent 4 }}
  annotations:
    {{- include "cbur.customAnnotations" (tuple .Values.global.annotations) | indent 4 }}
type: Opaque
stringData:
  {{- if .Values.AWSS3.access_key }}
  access_key: {{ .Values.AWSS3.access_key | quote }}
  {{- end }}
  {{- if .Values.AWSS3.secret_key }}
  secret_key: {{ .Values.AWSS3.secret_key | quote }}
  {{- end }}
  {{- if .Values.AWSS3.uid }}
  uid: {{ .Values.AWSS3.uid | quote }}
  {{- end }}
  {{- if .Values.AWSS3.access_token }}
  access_token: {{ .Values.AWSS3.access_token | quote }}
  {{- end }}
  {{- if .Values.AWSS3.region }}
  region: {{ .Values.AWSS3.region | quote }}
  {{- end }}
  {{- if .Values.AWSS3.http_proxy }}
  http_proxy: {{ .Values.AWSS3.http_proxy | quote }}
  {{- end }}
  {{- if .Values.AWSS3.predefined_bucket }}
  predefined_bucket: {{ .Values.AWSS3.predefined_bucket | quote }}
  {{- end }}
{{- end }}

{{- if and (not .Values.swiftS3.credentialName) .Values.swiftS3.accessKeyId .Values.swiftS3.secretAccessKey }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ template "cbur.fullname" . }}-secret-swifts3
  labels:
    {{- include "cbur.proxy.commonLabels" (tuple .) | indent 4 }}
    {{- include "cbur.customLabels" (tuple .Values.global.labels) | indent 4 }}
  annotations:
    {{- include "cbur.customAnnotations" (tuple .Values.global.annotations) | indent 4 }}
type: Opaque
stringData:
  {{- if .Values.swiftS3.accessKeyId }}
  accessKeyId: {{ .Values.swiftS3.accessKeyId | quote }}
  {{- end }}
  {{- if .Values.swiftS3.secretAccessKey }}
  secretAccessKey: {{ .Values.swiftS3.secretAccessKey | quote }}
  {{- end }}
  {{- if .Values.swiftS3.uid }}
  uid: {{ .Values.swiftS3.uid | quote }}
  {{- end }}
  {{- if .Values.swiftS3.region }}
  region: {{ .Values.swiftS3.region | quote }}
  {{- end }}
  {{- if .Values.swiftS3.endpointUrl }}
  endpointUrl: {{ .Values.swiftS3.endpointUrl | quote }}
  {{- end }}
data:
  {{- if .Values.swiftS3.caCrt }}
  caCrt: {{ .Values.swiftS3.caCrt | quote }}
  {{- end }}
{{- end }}

{{- if and (not .Values.SSH.credentialName) .Values.SSH.username .Values.SSH.host }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ template "cbur.fullname" . }}-secret-ssh
  labels:
    {{- include "cbur.proxy.commonLabels" (tuple .) | indent 4 }}
    {{- include "cbur.customLabels" (tuple .Values.global.labels) | indent 4 }}
  annotations:
    {{- include "cbur.customAnnotations" (tuple .Values.global.annotations) | indent 4 }}
type: Opaque
data:
  {{- if .Values.SSH.mode }}
  mode: {{ .Values.SSH.mode | b64enc | quote }}
  {{- end }}
  {{- if .Values.SSH.username }}
  username: {{ .Values.SSH.username | b64enc | quote }}
  {{- end }}
  {{- if .Values.SSH.host }}
  host: {{ .Values.SSH.host | b64enc | quote }}
  {{- end }}
  {{- if .Values.SSH.path }}
  path: {{ .Values.SSH.path | b64enc | quote }}
  {{- end }}
  {{- if .Values.SSH.strictHostKeyChecking }}
  strictHostKeyChecking: {{ .Values.SSH.strictHostKeyChecking | b64enc | quote }}
  {{- end }}
  {{- if .Values.SSH.hostKey }}
  hostKey: {{ .Values.SSH.hostKey | b64enc | quote }}
  {{- end }}
  {{- if .Values.SSH.port }}
  port: {{ toString (.Values.SSH.port) | b64enc | quote }}
  {{- end }}
{{- end }}
