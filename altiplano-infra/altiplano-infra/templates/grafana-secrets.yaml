{{ $grafanaGlobal := index .Values "global" "altiplano-grafana" }}
{{ $grafanaValues := index .Values "altiplano-grafana" }}
{{- if or ( .Values.tags.infra ) ( $grafanaGlobal.enabled ) ( $grafanaGlobal.enabled ) }}
{{- if and (not (hasKey $grafanaGlobal "enabled" )) (not (hasKey $grafanaValues "enabled" )) }}
{{ include "altiplano-grafana.secrets" . }}

{{- else if (not (hasKey $grafanaGlobal "enabled")) }}
  {{- if not (eq $grafanaValues.enabled false) }}
{{ include "altiplano-grafana.secrets" . }}
  {{- end }}

{{- else if (not (hasKey $grafanaValues "enabled" )) }}
  {{- if (not (eq $grafanaGlobal.enabled false)) }}
{{ include "altiplano-grafana.secrets" . }}
  {{- end }}

{{- else if and (not (eq $grafanaGlobal.enabled false)) (not (eq $grafanaValues.enabled false)) }}
{{ include "altiplano-grafana.secrets" . }}

{{- end }}
{{- end }}